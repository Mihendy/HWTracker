{% load static %}
{% csrf_token %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %} HWTracker {% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}">
</head>

<body>
<nav class="navbar navbar-expand navbar-dark bg-secondary fixed-top">
    <div class="container-fluid">

        <div class="d-flex align-items-center">
            <a class="navbar-brand nav-logo">
                <img src="{% static 'img/logo.svg' %}" alt="Logo" width="65" height="auto">
            </a>
            <div class="d-flex flex-column">
                <div class="fw-bold replace"
                     style="font-size: 20px; color: #ffffff;">{{ first_name }} {{ last_name }}</div>
                <div class="d-flex flex-row align-items-center">
                    {% if is_editor %}
                        <div class="fw-bold group" style="font-size: 20px; color: #ffffff;">
                            <i class="bi bi-pencil-square"></i>&nbsp;Редактор
                        </div>
                    {% else %}
                        <div class="fw-bold group" style="font-size: 20px; color: #ffffff;">
                            <i class="bi bi-people-fill"></i>&nbsp;{{ group }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="d-flex align-items-center">
            <div class="fw-bold username p-2"
                 style="font-size: 20px; color: #ffffff;">{{ first_name }} {{ last_name }}</div>

            <a href="/logout" class="btn btn-danger btn-lg" role="button">Выйти&nbsp;<i class="bi bi-door-closed"></i>
            </a>
        </div>

    </div>
</nav>


<a class="tg-button">
    <img src="{% static 'img/tg.png' %}" alt="Telegram">
</a>

<div class="d-flex flex-column grid-container p-3 w-100 list-group list-group-flush">
    {% if is_editor %}
        <div class="d-flex list-group-item">
            <div>
                <h5><span class="badge bg-secondary shadow invisible">00.00.0000</span></h5>
            </div>
            <a href="/taskform" class="add-button" style="width: 18rem; height: 18rem; margin: 1rem;">
                <img src="{% static 'img/add-button.svg' %}" alt="AddButton">
            </a>
        </div>
    {% endif %}
    {% for date, tasks in data.items %}
        <div class="d-flex list-group-item">
            <div>
                <h5><span class="badge bg-secondary shadow">{{ date|date:"d.m.Y" }}</span></h5>
            </div>
            <div class="d-flex flex-wrap">
                {% for task in tasks %}
                    <div {% if task.status == "completed" and not is_editor %}class="card border-dark mb-3 selectable-card selected-card"
                         {% else %}class="card border-dark mb-3 selectable-card"{% endif %}
                            {% if not is_editor %}
                         onclick="checkTask(this, '{{ task.id }}', '{{ task.status }}', '{{ user.id }}');" {% endif %}
                         style="width: 18rem; height: 18rem; margin: 1rem; position: relative;" id="{{ task.id }}">
                        <div class="card-header" style="font-weight: 800; cursor: pointer;">
                            {% if is_editor %}
                                <span class="highlight_remove" onclick="deleteTaskBlock('{{ task.id }}')">
                                    {{ task.subject }}
                                </span>
                            {% else %}
                                {{ task.subject }}
                            {% endif %}
                        </div>
                        <div class="card-body">
                            {% if is_editor %}
                                <a class="highlight_edit" href='/taskform/{{ task.id }}'>
                                    <h5 class="card-title" style="font-size: 14px; font-weight: bold;">{{ task.topic }}</h5>
                                    <p class="card-text" style="font-size: 15px;">{{ task.description }}</p>
                                    <p class="date">
                                        <i class="bi bi-clock-fill"></i>&nbsp;{{ task.due_date|date:"H:i" }}
                                    </p>
                                    <p class="task-group">
                                        <i class="bi bi-people-fill"></i>&nbsp;{{ task.group }}
                                    </p>
                                </a>
                            {% else %}
                                <h5 class="card-title" style="font-size: 14px; font-weight: bold;">{{ task.topic }}</h5>
                                <p class="card-text" style="font-size: 15px;">{{ task.description }}</p>
                                <p class="date">
                                    <i class="bi bi-clock-fill"></i>&nbsp;{{ task.due_date|date:"H:i" }}
                                </p>
                                <p class="task-group">
                                        <i class="bi bi-people-fill"></i>&nbsp;{{ task.group }}
                                </p>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>
<script src="{% static 'js/tasks.js' %}"></script>
</body>
</html>
